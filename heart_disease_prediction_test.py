# -*- coding: utf-8 -*-
"""Heart-disease-prediction-test.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/12fkvlvao0eoBYCs3DehJ8YzHykS4OdTf
"""

import keras   #Imports

from keras.models import Sequential
obj = Sequential()   #Model Creation

from keras.layers import Dense

import pandas as pd

dt = pd.read_csv('/content/heart.csv')   #Data Loading
dt.head()

dt.corr()

dt = dt.drop(['chol','fbs'],axis=1)

dt.tail(1)

x = dt.iloc[:,0:11]   #Feature Selection
y = dt['target']

x

from sklearn.model_selection import train_test_split   #Data Split
x_train,x_test,y_train,y_test = train_test_split(x,y,test_size=0.25)

print(x.shape,y.shape,x_train.shape,x_test.shape,y_train.shape,y_test.shape)

obj.add(Dense(units=11,activation='relu'))  #Model Architecture

obj.add(Dense(units=5,activation='relu'))

obj.add(Dense(units=1,activation='sigmoid'))

obj.build(input_shape=(None,11))

obj.summary()

obj.compile(optimizer='adam',loss='binary_crossentropy',metrics=['accuracy'])

obj.fit(x_train,y_train,epochs=100,batch_size=8,steps_per_epoch=x_train.shape[0]//8)

y_pred = obj.predict(x_test)

y_pred = (y_pred > 0.5).astype(int)

from sklearn.metrics import accuracy_score  #Evaluation
accuracy_score(y_test,y_pred)

obj.save('heart.h5')

x_train

x_train.columns

